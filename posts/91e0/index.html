<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>git repo 工具使用教程 | Winter's Blog</title><meta name="author" content="Winter"><meta name="copyright" content="Winter"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="git repo 工具使用教程1、repo 是什么？repo 是 Google 开发的用于管理 Android 版本库的一个工具，repo 是使用 Python 对 git 进行了一定的封装，并不是用于取代 git，它简化了对多个 Git 版本库的管理。用 repo 管理的版本库都需要使用 git 命令来进行操作。因此，使用 repo 工具之前，请先确保已经安装 git。 2、为什么要用 repo"><meta property="og:type" content="article"><meta property="og:title" content="git repo 工具使用教程"><meta property="og:url" content="https://winter-ruize.github.io/posts/91e0/index.html"><meta property="og:site_name" content="Winter&#39;s Blog"><meta property="og:description" content="git repo 工具使用教程1、repo 是什么？repo 是 Google 开发的用于管理 Android 版本库的一个工具，repo 是使用 Python 对 git 进行了一定的封装，并不是用于取代 git，它简化了对多个 Git 版本库的管理。用 repo 管理的版本库都需要使用 git 命令来进行操作。因此，使用 repo 工具之前，请先确保已经安装 git。 2、为什么要用 repo"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://winter-ruize.github.io/images/avatar.jpg"><meta property="article:published_time" content="2024-02-01T08:53:39.000Z"><meta property="article:modified_time" content="2024-04-09T06:06:19.000Z"><meta property="article:author" content="Winter"><meta property="article:tag" content="git"><meta property="article:tag" content="repo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://winter-ruize.github.io/images/avatar.jpg"><link rel="shortcut icon" href="/images/avatar_circle.png"><link rel="canonical" href="https://winter-ruize.github.io/posts/91e0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,noticeOutdate:{limitDay:365,position:"top",messagePrev:"It has been",messageNext:"days since the last update, the content of the article may be outdated."},highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!0,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: Winter",link:"链接: ",source:"来源: Winter's Blog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"git repo 工具使用教程",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-04-09 14:06:19"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),document.head.appendChild(n)}),e.getCSS=(e,t=!1)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{const d=document.getElementById("loading-box"),e=document.body,o=()=>{e.style.overflow="",d.classList.add("loaded")},l=()=>{e.style.overflow="hidden",d.classList.remove("loaded")};l(),window.addEventListener("load",()=>{o()})})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messagesboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/images/wallpaper/wallpaper-013.jpg)"><nav id="nav"><span id="blog-info"><a href="/" title="Winter's Blog"><span class="site-name">Winter's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messagesboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">git repo 工具使用教程<a class="post-edit-link" href="https://github.com/winter-ruize/hexo_blog/edit/main/source/_posts/git repo工具使用教程.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-02-01T08:53:39.000Z" title="发表于 2024-02-01 16:53:39">2024-02-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-09T06:06:19.000Z" title="更新于 2024-04-09 14:06:19">2024-04-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/git/">git</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>20分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="git repo 工具使用教程"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="git-repo-工具使用教程"><a href="#git-repo-工具使用教程" class="headerlink" title="git repo 工具使用教程"></a>git repo 工具使用教程</h1><h2 id="1、repo-是什么？"><a href="#1、repo-是什么？" class="headerlink" title="1、repo 是什么？"></a>1、repo 是什么？</h2><p>repo 是 Google 开发的用于管理 Android 版本库的一个工具，repo 是使用 Python 对 git 进行了一定的封装，并不是用于取代 git，它简化了对多个 Git 版本库的管理。用 repo 管理的版本库都需要使用 git 命令来进行操作。因此，使用 repo 工具之前，请先确保已经安装 git。</p><h2 id="2、为什么要用-repo？"><a href="#2、为什么要用-repo？" class="headerlink" title="2、为什么要用 repo？"></a>2、为什么要用 repo？</h2><p>项目模块化&#x2F;组件化之后各模块也作为独立的 Git 仓库从主项目里剥离了出去，各模块各自管理自己的版本。Android 源码引用了很多开源项目，每一个子项目都是一个 Git 仓库，每个 Git 仓库都有很多分支版本，为了方便统一管理各个子项目的 Git 仓库，需要一个上层工具批量进行处理，因此 repo 诞生。</p><p>repo 也会建立一个 Git 仓库，用来记录当前 Android 版本下各个子项目的 Git 仓库分别处于哪一个分支，这个仓库通常叫做：manifest 仓库(清单库)。</p><h2 id="3、repo-下载安装"><a href="#3、repo-下载安装" class="headerlink" title="3、repo 下载安装"></a>3、repo 下载安装</h2><p>下载地址：</p><p>google 地址：<a target="_blank" rel="noopener" href="https://storage.googleapis.com/git-repo-downloads/repo">https://storage.googleapis.com/git-repo-downloads/repo</a></p><p>国内镜像地址：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/git/git-repo">https://mirrors.tuna.tsinghua.edu.cn/git/git-repo</a></p><p>将下载下来的文件命名为 repo，放在 <code>PATH</code> 环境变量所包含的目录下面，例如可以放在 <code>/usr/local/bin</code> 目录下（后面介绍均以放在 <code>/usr/local/bin</code> 目录下为例）。</p><p>可使用 <code>curl</code> 命令直接下载，下载后需为 repo 文件添加可执行权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl https://storage.googleapis.com/git-repo-downloads/repo &gt; /usr/local/bin/repo</span><br><span class="line">or</span><br><span class="line">curl https://mirrors.tuna.tsinghua.edu.cn/git/git-repo &gt; /usr/local/bin/repo</span><br><span class="line"></span><br><span class="line">chmod 755 /usr/local/bin/repo</span><br></pre></td></tr></table></figure><blockquote><p>其实下载下来的 repo 文件只是一个使用 Python 编写的引导脚本（Google 称之为 Repo launcher，本质上是一个 python 脚本，可以使用 vim 打开的），完整的 repo(即，repo 的主体部分)还没有下载。</p></blockquote><h2 id="4、repo-help"><a href="#4、repo-help" class="headerlink" title="4、repo help"></a>4、repo help</h2><p>查看 repo 帮助说明，该帮助列举了 repo 所支持的子命令，及各个子命令的简要介绍。</p><p>如果需要查看某个具体子命令的详细介绍，执行命令 <code>repo help &lt;command&gt;</code> 即可。例如查看 <code>repo init</code> 的帮助，可以输入 <code>repo help init</code>。</p><blockquote><p>上一小节已经提及到了，下载下来的repo只是一个引导脚本，完整的repo工具还没有下载，如下图所示，此时使用 <code>repo help</code> 只能看到 <code>init</code> 和 <code>help</code> 两个子命令，而且帮助信息中还会提示 repo 还未安装，需要执行 <code>repo init</code> 安装。(需要注意 <code>repo init</code> 需要跟参数的，详见后续 <code>repo init</code> 的介绍使用)</p></blockquote><p><img src="/images/loading.gif" data-original="https://github.com/winter-ruize/blog_images/raw/main/images/2024/01/31/1706702493283.png" alt="image-20230516104632349"></p><blockquote><p>当执行完 <code>repo init</code> 下载了完整的repo工具之后，再执行 <code>repo help</code> 就会看到 repo 更多的子命令。如下图所示：</p></blockquote><p><img src="/images/loading.gif" data-original="https://github.com/winter-ruize/blog_images/raw/main/images/2024/01/31/1706702493392.png" alt="image-20230516104715969"></p><h2 id="5、repo-version"><a href="#5、repo-version" class="headerlink" title="5、repo version"></a>5、repo version</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo version</span><br></pre></td></tr></table></figure><p>查看repo的版本</p><h2 id="6、repo-selfupdate"><a href="#6、repo-selfupdate" class="headerlink" title="6、repo selfupdate"></a>6、repo selfupdate</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo selfupdate</span><br></pre></td></tr></table></figure><p>用于 repo 自身的更新。如果有新版本的 repo 存在, 这个命令会升级 repo 到最新版本。通常这个动作在 <code>repo sync</code> 时会自动去做, 所以不需要最终用户手动去执行。</p><p><strong>常用选项：</strong></p><ul><li><code>--no-repo-verify</code>：不要验证 repo 源码.</li></ul><h2 id="7、repo-init"><a href="#7、repo-init" class="headerlink" title="7、repo init"></a>7、repo init</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">repo init [options] [manifest url]</span><br><span class="line">repo init -u manifest_git_path -m manifest_file_name -b branch_name --repo-url=repo_url --no-repo-verify</span><br></pre></td></tr></table></figure><p>首先当前目录产生一个 <code>.repo</code> 目录</p><p>然后克隆一份 repo 的源代码到 <code>.repo/repo</code> 下，里面存放了其他 repo 子命令，即 repo 的主体部分。</p><p>接着从 <code>manifest_git_path</code> 仓库地址 clone 清单库到 <code>.repo/manifests和.repo/manifests.git</code> 目录。</p><p>同时 <code>.repo</code> 目录下还包括 manifest 仓库(清单库)内容</p><p><strong>常用选项：</strong></p><ul><li><code>-u</code>：指定 Manifest 库的 Git 访问路径。<strong>唯一必不可少的选项</strong></li><li><code>-m</code>：指定要使用的 Manifest 文件。不指定的话，默认为 default.xml 文件</li><li><code>-b</code>：指定要使用 Manifest 仓库中的某个特定分支。</li><li><code>--repo-url</code>：指定 repo 的远端 repoGit 库的访问路径。</li><li><code>--no-repo-verify</code>：指定不要验证 repo 源码。</li><li><code>--mirror</code>：创建远程存储库的副本，而不是客户端工作目录。该选项用于创建版本库镜像。使用该选项则在下一步 <code>repo sync</code> 同步时，本地按照源的版本库组织方式进行组织，否则会按照 manifest.xml 指定的方式重新组织并检出到本地</li></ul><h3 id="7-1、修改获取repo的源码路径"><a href="#7-1、修改获取repo的源码路径" class="headerlink" title="7.1、修改获取repo的源码路径"></a>7.1、修改获取repo的源码路径</h3><p>repo主体部分默认从 <a target="_blank" rel="noopener" href="https://gerrit.googlesource.com/git-repo">https://gerrit.googlesource.com/git-repo</a> 获取(即，执行 <code>repo init</code> 命令时，不设置 <code>--repo-url</code> 选项），国内需进行代理上网才可以。</p><h4 id="解决方案1："><a href="#解决方案1：" class="headerlink" title="解决方案1："></a>解决方案1：</h4><p>每次执行 <code>repo init</code> 时，增加选项 <code>--repo-url=https://gerrit-googlesource.lug.ustc.edu.cn/git-repo</code></p><h4 id="解决方案2："><a href="#解决方案2：" class="headerlink" title="解决方案2："></a>解决方案2：</h4><p>设置环境变量 <code>REPO_URL</code> ,可以加在启动脚本中（例，<code>/etc/profile</code>、<code>~/.bashrc</code> ）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export REPO_URL=&#x27;https://mirrors.tuna.tsinghua.edu.cn/git/git-repo&#x27;</span><br></pre></td></tr></table></figure><h2 id="8、-repo-文件夹简介"><a href="#8、-repo-文件夹简介" class="headerlink" title="8、.repo 文件夹简介"></a>8、.repo 文件夹简介</h2><p>执行 <code>repo init</code> 命令之后，会在当前目录创建一个 <code>.repo</code> 文件夹。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tree .repo -L 1</span></span><br><span class="line">.repo</span><br><span class="line">├── manifests</span><br><span class="line">├── manifests.git</span><br><span class="line">├── manifest.xml</span><br><span class="line">└── repo</span><br><span class="line"></span><br><span class="line">3 directories, 1 file</span><br></pre></td></tr></table></figure><table><thead><tr><th>文件夹</th><th>描述</th></tr></thead><tbody><tr><td>manifests</td><td>manifest 仓库(清单库)内容，即 <code>repo init</code> 的 <code>-u</code> 选项对应的仓库</td></tr><tr><td>manifests.git</td><td>manifest 仓库(清单库)的.git目录</td></tr><tr><td>manifest.xml</td><td>指明当前生效的 Manifest 文件，即 <code>repo init</code> 的 <code>-m</code> 选项对应的参数(没有该选项时默认为default.xml)</td></tr><tr><td>repo</td><td>repo 命令的主体，包含了最新的 repo 命令</td></tr></tbody></table><h2 id="9、manifest-文件介绍"><a href="#9、manifest-文件介绍" class="headerlink" title="9、manifest 文件介绍"></a>9、manifest 文件介绍</h2><p>所谓 manifest 仓库(清单库)其实就是存放 manifest (清单)文件的仓库，实际上可以是任意仓库，只要该仓库中存在 <code>repo init</code> 命令 <code>-m</code> 选项指定的manifest文件即可，清单库命名为 <code>manifest</code> 只不过是一种约定俗成的写法罢了。</p><p>manifest 仓库一般都会有一个 default.xml 文件，该文件为默认的 manifest 文件。</p><h3 id="9-1、manifest-文件格式"><a href="#9-1、manifest-文件格式" class="headerlink" title="9.1、manifest 文件格式"></a>9.1、manifest 文件格式</h3><p>manifest 文件是用 XML 文件的格式记录了本项目依赖的各个 Git 仓库的名称、地址，以及分支等信息。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">remote</span> <span class="attr">fetch</span>=<span class="string">&quot;ssh://git@git.software.team/learn-repo&quot;</span> <span class="attr">name</span>=<span class="string">&quot;origin&quot;</span> <span class="attr">review</span>=<span class="string">&quot;http://xxx.xxx.xxx:8080&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">remote</span> <span class="attr">fetch</span>=<span class="string">&quot;https://github.com&quot;</span> <span class="attr">name</span>=<span class="string">&quot;github&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;origin&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">default</span> <span class="attr">remote</span>=<span class="string">&quot;origin&quot;</span> <span class="attr">revision</span>=<span class="string">&quot;master&quot;</span> <span class="attr">sync-j</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project</span> <span class="attr">name</span>=<span class="string">&quot;build&quot;</span> <span class="attr">path</span>=<span class="string">&quot;build&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">linkfile</span> <span class="attr">dest</span>=<span class="string">&quot;build.sh&quot;</span> <span class="attr">src</span>=<span class="string">&quot;build.sh&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project</span> <span class="attr">name</span>=<span class="string">&quot;docs&quot;</span> <span class="attr">path</span>=<span class="string">&quot;docs&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">copyfile</span> <span class="attr">dest</span>=<span class="string">&quot;README.md&quot;</span> <span class="attr">src</span>=<span class="string">&quot;README.md&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project</span> <span class="attr">name</span>=<span class="string">&quot;third_party/openssl&quot;</span> <span class="attr">path</span>=<span class="string">&quot;third_party/openssl&quot;</span> <span class="attr">revision</span>=<span class="string">&quot;OpenSSL_1_1_1l&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project</span> <span class="attr">name</span>=<span class="string">&quot;curl/curl&quot;</span> <span class="attr">path</span>=<span class="string">&quot;third_party/curl&quot;</span> <span class="attr">remote</span>=<span class="string">&quot;github&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project</span> <span class="attr">name</span>=<span class="string">&quot;src&quot;</span> <span class="attr">path</span>=<span class="string">&quot;src&quot;</span> <span class="attr">revision</span>=<span class="string">&quot;release&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-2、remote-元素"><a href="#9-2、remote-元素" class="headerlink" title="9.2、remote 元素"></a>9.2、remote 元素</h3><p>remote 元素可以有多个，用于存在多个 git 远程服务器的情况。</p><ul><li><code>fetch</code>：使用此 <code>remote</code> 的所有项目的 Git URL 前缀。 每个项目的名称都附加到此前缀以形成用于克隆项目的实际 URL。如果使用此 <code>remote</code>的所有项目的前缀和 manifest 仓库前置一致的话，可以使用 <code>..</code> 代替。</li><li><code>name</code>：此清单文件唯一的短名称。此处指定的名称用作每个项目的 <code>.git/config</code> 中的远程名称，因此可自动用于 <code>git fetch</code>、<code>git remote</code>、<code>git pull</code> 和 <code>git push</code> 等命令。</li><li><code>review</code>：通过 <code>repo upload</code> 将评论上传到的 <code>Gerrit</code> 服务器的主机名。该属性是可选的；如果未指定，则 <code>repo upload</code> 将不起作用。</li><li><code>alias</code>：该属性可以省略，当指定了该属性时，可以覆盖 <code>name</code> 属性设置每个项目的 <code>.git/config</code> 中的远程名称。不同 <code>remote</code> 元素的 <code>alias</code> 属性可以相同，比如不同 <code>remote</code> 元素的 <code>alias</code> 属性可以都是 <code>origin</code>。</li></ul><h3 id="9-3、default-元素"><a href="#9-3、default-元素" class="headerlink" title="9.3、default 元素"></a>9.3、default 元素</h3><p>default元素只能有一个。</p><ul><li><code>remote</code>：<code>project</code> 部分不单独指定 <code>remote</code> 的话就使用 <code>default</code> 部分的。</li><li><code>revision</code>：<code>project</code> 部分不单独指定 <code>revision</code> 的话就使用 <code>default</code> 部分的。</li><li><code>sync-j</code>：同步时(执行 <code>repo sync</code> 命令时)使用的并行作业数</li><li><code>sync_c</code>：如果设置为 <code>true</code>，则只同步指定的分支( <code>revision</code> 属性指定)，而不是所有的 <code>ref</code> 内容</li><li><code>sync_s</code>：如果设置为 <code>true</code>，则会同步git的子项目</li></ul><h3 id="9-4、project-元素"><a href="#9-4、project-元素" class="headerlink" title="9.4、project 元素"></a>9.4、project 元素</h3><p>该部分定义了项目代码由哪些子仓库组成</p><ul><li><code>name</code>：相对于 <code>remote</code> 部分 <code>fetch</code> 指定的前缀的相对路径</li><li><code>path</code>：把代码下载下来后在本地的相对于当前路径的相对路径</li><li><code>revision</code>：是指下载下来的代码要 <code>checkout</code> 到哪个 <code>revision</code> 上，这里的 <code>revision</code> 可以是commit id、branch</li><li><code>name</code>、<code>tag name</code>，本质上都是 commit id。default.xml 中通常用 branch name 做 <code>revision</code>，可以下载到并且 <code>checkout</code> 出该 branch 上最新的代码，标签和 &#x2F; 或 commit id 在理论上应该有效，但尚未经过广泛测试。如果 <code>revision</code> 使用 commit id 的话，那后面必须跟上 <code>upstream</code>，<code>upstream</code> 的值是个 branch name。<code>revision</code> 部分如果省略的话，就等于使用 <code>default</code> 部分定义的 <code>revision</code>。</li><li><code>remote</code>：前面定义的远程元素的名称。如果未提供，则使用默认元素提供的值。</li></ul><h3 id="9-5、copyfile-元素"><a href="#9-5、copyfile-元素" class="headerlink" title="9.5、copyfile 元素"></a>9.5、copyfile 元素</h3><p><code>project</code> 元素的子元素，每个元素描述了一对 <code>src-dest</code> 文件对。同步时(即执行 <code>repo sync</code> 命令时) <code>src</code> 文件会被拷贝到 <code>dest</code>。通常会被用于 README 或 Makefile 或其他构建脚本。</p><ul><li><code>dest</code>：是相对于当前目录(执行 <code>repo init</code> 和 <code>repo sync</code> 命令的目录)的路径</li><li><code>src</code>：是相对于 <code>project path</code> 的相对路径</li></ul><h3 id="9-6、linkfile-元素"><a href="#9-6、linkfile-元素" class="headerlink" title="9.6、linkfile 元素"></a>9.6、linkfile 元素</h3><p>与 <code>copyfile</code> 类似，只不过不是拷贝，而是建立软连接。</p><p>更多关于manifest文件的格式的介绍，可以在 <code>repo init</code> 命令成功执行后，在代码根目录下的 <code>.repo/repo/docs</code> 下看到相关文档说明(问：不会写 manifest 文件，就无法创建清单库，从而无法执行 <code>repo init</code> 怎么办？答：找个开源清单库执行 <code>repo init</code> 即可，或者去 github 上下载一份 repo 的源码)。最简单的方式是直接去网站 <a target="_blank" rel="noopener" href="https://gerrit-googlesource.proxy.ustclug.org/git-repo/+/HEAD/docs/manifest-format.md">https://gerrit-googlesource.proxy.ustclug.org/git-repo/+/HEAD/docs/manifest-format.md</a> 查看帮助。</p><h2 id="10、repo-sync"><a href="#10、repo-sync" class="headerlink" title="10、repo sync"></a>10、repo sync</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo sync [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>初始化好一个 repo 工作目录后下一步就是把代码同步下来了，该命令用来下载新的更改并更新本地环境中的工作文件。如果您在未使用任何参数的情况下运行 <code>repo sync</code>，则该操作<strong>会同步所有项目</strong>(所有项目是指 manifest 文件中所有的 project 元素)的文件。</p><ul><li><code>&lt;project&gt;</code>：为 manifest 文件中 <code>project</code> 元素的 <code>name</code> 属性或者 <code>path</code> 属性的值。如果只需要同步某一个或者个别几个项目的话，就可以采用这种方法。</li></ul><p>运行 <code>repo sync</code> 后，将出现以下情况：</p><ul><li><p>如果目标项目从未同步过，则 <code>repo sync</code> 相当于 <code>git clone</code>。远程代码库中的所有分支都会复制到本地项目目录中。</p></li><li><p>如果目标项目已同步过，则 <code>repo sync</code> 相当于以下命令：</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote update</span><br><span class="line">git rebase origin/&lt;BRANCH&gt;</span><br></pre></td></tr></table></figure><p>其中 <code>&lt;BRANCH&gt;</code> 是本地项目目录中当前已检出的分支。如果本地分支没有在跟踪远程代码库中的分支，则相应项目不会发生任何同步。</p><ul><li>如果 <code>git rebase</code> 操作导致合并冲突，那么您需要使用普通Git命令（例如 <code>git rebase --continue</code>）来解决冲突。</li></ul><p><code>repo sync</code> 运行成功后，指定项目中的代码会与远程代码库中的代码保持同步。</p><p><strong>常用选项：</strong></p><ul><li><code>-d</code>：将指定项目切换回清单修订版本。如果项目当前属于某个主题分支，但只是临时需要清单修订版本，则此选项会有所帮助。</li><li><code>-s</code>：同步到当前清单中清单服务器元素指定的一个已知的良好版本。</li><li><code>-f</code>：即使某个项目同步失败，系统也会继续同步其他项目。</li><li><code>-t</code>：使用对应tag里的 manifest 文件</li><li><code>-m</code>：手动指定当前操作使用哪个 manifest 文件</li><li><code>--force-sync</code>：如果需要，强制覆盖现有的 git 目录指向不同的对象目录。此操作可能会导致数据丢失</li></ul><blockquote><p><strong><code>repo sync</code> 后 <code>git branch -a</code> 显示中 “no branch” 和 “remotes&#x2F;m&#x2F;master” 的含义</strong></p><p>使用 repo 工具同步代码之后，进入任意项目路径下，执行 <code>git branch -a</code> 输出如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* (no branch)</span><br><span class="line">  remotes/m/master -&gt; origin/dev</span><br><span class="line">  remotes/origin/dev</span><br><span class="line">  remotes/origin/master</span><br></pre></td></tr></table></figure><ol><li><p>输出中的后两行比较好理解，就是该仓库的远程仓库里存在的分支。</p></li><li><p>输出的第一行 <code>* (no branch)</code> 中的 <code>*</code> 表示当前所在的分支，该行意思是，当前不再任何分支上。</p></li></ol><p>为什么会显示 <code>no branch</code> 呢？</p><p><code>repo sync</code> 只是根据清单文件中 <code>revision</code> 版本进行更新的，没有固定的 branch，<code>repo sync</code> 成功之后，不能直接进行操作，需要先执行 <code>repo start</code> 建立新的分支进行开发。</p><p>其实，执行 <code>repo branches</code> 命令也会显示 no branches 的，这个就更好理解了，不同的子仓库的 <code>revision</code> 不尽相同，所有git仓库放在一起，更是没有一个确切的branch了。</p><ol start="3"><li>输出的第二行中 <code>remotes/m/master -&gt; origin/dev</code> 又是什么意思呢？</li></ol><p>前一部分表示 repo 清单库( manifest 仓库)的分支，即执行 <code>repo init</code> 命令时 <code>-b</code> 选项的参数，如果执行 <code>repo init</code> 命令时没有指定 <code>-b</code> 选项，则表示默认采用清单库的 master 分支。</p><p>箭头所指的后一部分 <code>origin/dev</code>，表示当前所使用的清单文件(.xml文件)里面指定的单个git库的 <code>revision</code> 值（即，清单文件中 <code>project</code> 元素的 <code>revision</code> 属性，如果 <code>project</code> 元素没有指定 <code>revision</code> 属性，则默认使用的是 <code>default</code> 元素的 <code>revision</code> 属性）。</p><p>这样做的目的是：为了让用户方便的知道自己目前工作在清单库的哪个分支上。当前的清单库的这个分支又引用了当前 git 库的哪个 <code>branch/tag</code> 上</p></blockquote><h2 id="11、repo-start"><a href="#11、repo-start" class="headerlink" title="11、repo start"></a>11、repo start</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo start &lt;newbranchname&gt; [--all | &lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>创建并切换分支。<strong>刚克隆下来的代码是没有分支的</strong>，<code>repo start</code> 实际是对 <code>git checkout -b</code> 命令的封装。</p><p>为指定的项目或所有的项目（若使用 <code>-all</code>），以清单文件中为设定的分支，创建特定的分支。</p><p><strong>常用选项：</strong></p><ul><li><code>&lt;newbranchname&gt;</code>：参数应简要说明您尝试对项目进行的更改。</li><li><code>&lt;project&gt;</code>：指定了将参与此主题分支的项目。</li></ul><blockquote><p>tip：可以使用<code>.</code>表示当前工作目录中的所有项目</p></blockquote><p>这条指令与 <code>git checkout -b</code> 还是有很大区别的。</p><ul><li><p><code>git checkout -b</code>：是在当前所在的分支的基础上创建特性分支。</p></li><li><p><code>repo start</code>：是在清单文件设定的分支的基础上创建特性分支。</p></li></ul><h2 id="12、repo-status"><a href="#12、repo-status" class="headerlink" title="12、repo status"></a>12、repo status</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo status [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>查看文件状态。对于每个指定的项目，将工作树与临时区域（索引）以及此分支 (HEAD) 上的最近一次提交进行比较。在这三种状态存在差异之处显示每个文件的摘要行。</p><p>要仅查看当前分支的状态，请运行 <code>repo status</code>。系统会按项目列出状态信息。对于项目中的每个文件，系统使用两个字母的代码来表示：</p><ul><li>在第一列中，大写字母表示临时区域与上次提交状态之间的不同之处。</li></ul><table><thead><tr><th>字母</th><th>含义</th><th>描述</th></tr></thead><tbody><tr><td>-</td><td>无更改</td><td>HEAD 与索引中相同</td></tr><tr><td>A</td><td>已添加</td><td>不存在于 HEAD 中，但存在于索引中</td></tr><tr><td>M</td><td>已修改</td><td>存在于 HEAD 中，但索引中的文件已修改</td></tr><tr><td>D</td><td>已删除</td><td>存在于 HEAD 中，但不存在于索引中</td></tr><tr><td>R</td><td>已重命名</td><td>不存在于 HEAD 中，但索引中的文件的路径已更改</td></tr><tr><td>C</td><td>已复制</td><td>不存在于 HEAD 中，已从索引中的另一个文件复制</td></tr><tr><td>T</td><td>模式已更改</td><td>HEAD 与索引中的内容相同，但模式已更改</td></tr><tr><td>U</td><td>未合并</td><td>HEAD 与索引中的内容相同，但模式已更改</td></tr></tbody></table><ul><li>在第二列中，小写字母表示工作目录与索引之间的不同之处。</li></ul><table><thead><tr><th>字母</th><th>含义</th><th>描述</th></tr></thead><tbody><tr><td>-</td><td>新&#x2F;未知</td><td>HEAD 与索引中相同</td></tr><tr><td>m</td><td>已修改</td><td>存在于索引中，也存在于工作树中（但已修改）</td></tr><tr><td>d</td><td>已删除</td><td>存在于索引中，不存在于工作树中</td></tr></tbody></table><p>两个表示状态的字母后面，显示文件名信息。如果有文件重名还会显示改变前后的文件名及文件的相似度。</p><h2 id="13、repo-checkout"><a href="#13、repo-checkout" class="headerlink" title="13、repo checkout"></a>13、repo checkout</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo checkout &lt;branchname&gt; [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>切换分支。 实际上是对 <code>git checkout</code> 命令的封装，但不能带 <code>-b</code> 参数，所以不能用此命令来创建特性分支。</p><p>该命令等同于：<code>repo forall [&lt;project&gt;...] -c git checkout &lt;branchname&gt;</code></p><h2 id="14、repo-branch"><a href="#14、repo-branch" class="headerlink" title="14、repo branch"></a>14、repo branch</h2><p>该命令等同于 <code>repo branches</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo branches [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>汇总当前所有可用的主题分支。</p><h2 id="15、repo-diff"><a href="#15、repo-diff" class="headerlink" title="15、repo diff"></a>15、repo diff</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo diff [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>查看工作区文件差异。实际是对 <code>git diff</code> 命令的封装，用于分别显示各个项目或指定项目工作区下的文件差异。在 commit 和工作目录之间使用 <code>git diff</code> 显示明显差异的更改。</p><h2 id="16、repo-stage"><a href="#16、repo-stage" class="headerlink" title="16、repo stage"></a>16、repo stage</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo stage -i [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>把文件添加到 index 表中。实际上是对 <code>git add --interactive</code> 命令的封装，用于挑选各个项目中的改动以加入暂存区。</p><p><strong>常用选项：</strong></p><ul><li><code>-i</code>：表示 <code>git add --interactive</code> 命令中的 <code>--interactive</code> ，给出一个界面供用户选择。</li></ul><h2 id="17、repo-forall"><a href="#17、repo-forall" class="headerlink" title="17、repo forall"></a>17、repo forall</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo forall [&lt;project&gt;...] -c &lt;command&gt; [&lt;arg&gt;...]</span><br></pre></td></tr></table></figure><p>在每个项目中运行指定的 shell 命令。通过 <code>repo forall</code> 可使用下列额外的环境变量：</p><ul><li><code>REPO_PROJECT</code>：项目的名称。</li><li><code>REPO_PATH</code>：项目在该工作区的相对路径。</li><li><code>REPO_REMOTE</code>：项目远程仓库的名称。</li><li><code>REPO_LREV</code>：manifest 文件中 <code>revision</code> 属性，已转换为本地跟踪分支。如果您需要将 manifest 中 <code>revision</code> 值传递到某个本地运行的 Git 命令，则可使用此变量。</li><li><code>REPO_RREV</code>：manifest 文件中 <code>revision</code> 属性，与 manifest 文件中显示的名称完全一致。</li></ul><p><strong>常用选项：</strong></p><ul><li><code>-c</code>：要运行的命令和参数，即 shell 命令。此命令会通过 <code>/bin/sh</code> 进行求值，它之后的任何参数都将作为 shell 位置参数传递。</li><li><code>-p</code>：在指定命令输出结果之前显示项目标头。这通过以下方式实现：将管道绑定到命令的 <code>stdin</code>、<code>stdout</code> 和 <code>sterr</code> 流，然后通过管道将所有输出结果传输到一个页面调度会话中显示的连续流中。</li><li><code>-v</code>：显示该命令向 <code>stderr</code> 写入的消息。</li></ul><blockquote><p>注意：shell 指令中有上述环境变量时，则需要用使用单引号把 shell 命令括起来。</p></blockquote><p><strong>示例：</strong></p><ol><li>打印项目列表</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo forall -c &#x27;echo $REPO_PROJECT&#x27;</span><br></pre></td></tr></table></figure><ol start="2"><li>打印项目路径</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo forall -c &#x27;echo $REPO_PATH&#x27;</span><br></pre></td></tr></table></figure><h2 id="18、repo-prune"><a href="#18、repo-prune" class="headerlink" title="18、repo prune"></a>18、repo prune</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo prune [&lt;PROJECT_LIST&gt;]</span><br></pre></td></tr></table></figure><p>删除已经合并分支。实际上是对 <code>git branch -d</code> 命令的封装，该命令用于扫描项目的各个分支，并删除已经合并的分支。</p><h2 id="19、repo-abandon"><a href="#19、repo-abandon" class="headerlink" title="19、repo abandon"></a>19、repo abandon</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo abandon [--all | &lt;branchname&gt;] [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>删除指定分支。实际是对 <code>git brance -D</code> 命令的封装。</p><h2 id="20、repo-upload"><a href="#20、repo-upload" class="headerlink" title="20、repo upload"></a>20、repo upload</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo upload [--re --cc] [&lt;project&gt;]...</span><br></pre></td></tr></table></figure><p>对于指定的项目，repo会将本地分支与最后一次 <code>repo sync</code> 时更新的远程分支进行比较。repo 会提示您选择一个或多个尚未上传以供审核的分支。</p><blockquote><p>注意：使用 <code>repo upload</code> 需要搭建 gerrit 环境，并且在 manifest 文件 <code>remote</code> 元素中添加 <code>review</code> 属性</p></blockquote><p>您选择一个或多个分支后，所选分支上的所有提交都会通过 HTTPS 连接传输到 Gerrit。您需要配置一个 HTTPS 密码以启用上传授权。要生成新的用户名&#x2F;密码对以用于 HTTPS 传输，请访问密码生成器。</p><p>当 Gerrit 通过其服务器接收对象数据时，它会将每项提交转变成一项更改，以便审核者可以单独针对每项提交给出意见。要将几项“检查点”提交合并为一项提交，请使用 <code>git rebase -i</code>，然后再运行 <code>repo upload</code>。</p><p>如果您在未使用任何参数的情况下运行 <code>repo upload</code>，则该操作会搜索所有项目中的更改以进行上传。</p><p>要在更改上传之后对其进行修改，您应该使用 <code>git rebase -i</code> 或 <code>git commit --amend</code> 等工具更新您的本地提交。修改完成之后，请执行以下操作：</p><ul><li>进行核对以确保更新后的分支是当前已检出的分支。</li><li>对于相应系列中的每项提交，请在方括号内输入 Gerrit 更改 ID：</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Replacing from branch foo</span></span><br><span class="line">[ 3021 ] 35f2596c Refactor part of GetUploadableBranches to lookup one specific...</span><br><span class="line">[ 2829 ] ec18b4ba Update proto client to support patch set replacments</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Insert change numbers <span class="keyword">in</span> the brackets to add a new patch <span class="built_in">set</span>.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">To create a new change record, leave the brackets empty.</span></span><br></pre></td></tr></table></figure><p>上传完成后，这些更改将拥有一个额外的补丁程序集。</p><p><code>repo upload</code> 相当于 <code>git push</code>，但是又有很大的不同。它将版本库改动推送到代码审核服务器（Gerrit 软件架设）的特殊引用上。代码审核服务器会对推送的提交进行特殊处理，将新的提交显示为一个待审核的修改集，并进入代码审核流程，只有当审核通过后，才会合并到官方正式的版本库中。</p><p><strong>常用选项：</strong></p><ul><li><code>-t</code>：发送本地分支名称到 Gerrit 代码审核服务器</li><li><code>--re=REVIEWERS</code>：要求指定的人员进行审核</li><li><code>--cc=CC</code>：同时发送通知到如下邮件地址</li></ul><h2 id="21、repo-download"><a href="#21、repo-download" class="headerlink" title="21、repo download"></a>21、repo download</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo download &#123;[project] change[/patchset]&#125;...</span><br></pre></td></tr></table></figure><p>从审核系统中下载指定更改，并放在您项目的本地工作目录中供使用。</p><p>例如，要将 <a target="_blank" rel="noopener" href="https://android-review.googlesource.com/23823">更改 23823</a> 下载到您的平台&#x2F;编译目录，请运行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo download platform/build 23823</span><br></pre></td></tr></table></figure><p><code>repo sync</code> 应该可以有效移除通过 <code>repo download</code> 检索到的任何提交。或者，您可以将远程分支检出，例如 <code>git checkout m/master</code>。</p><blockquote><p>repo download 命令主要用于代码审核者下载和评估贡献者提交的修订。</p><p>贡献者的修订在 Git 版本库中 refs&#x2F;changes&#x2F;&#x2F; 引用方式命名（缺省的 patchset 为1），和其他 Git 引用一样，用 <code>git fetch</code> 获取，该引用所指向的最新的提交就是贡献者待审核的修订。</p><p>使用 <code>repo download</code> 命令实际上就是用 <code>git fetch</code> 获取到对应项目的 <code>refs/changes//patchset&gt;</code> 引用，并自动切换到对应的引用上。</p></blockquote><h2 id="22、repo-grep"><a href="#22、repo-grep" class="headerlink" title="22、repo grep"></a>22、repo grep</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo grep &#123;pattern | -e pattern&#125; [&lt;project&gt;...]</span><br></pre></td></tr></table></figure><p>打印出符合某个模式的行。相当于对 <code>git grep</code> 的封装，用于在项目文件中进行内容查找。</p><h2 id="23、repo-manifest"><a href="#23、repo-manifest" class="headerlink" title="23、repo manifest"></a>23、repo manifest</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo manifest [-o &#123;-|NAME.xml&#125;] [-m MANIFEST.xml] [-r]</span><br></pre></td></tr></table></figure><p>manifest 检验工具，用于显示当前使用的manifest文件内容。</p><p><strong>常用选项：</strong></p><ul><li><code>-r</code>, <code>--revision-as-HEAD</code>：把某版次存为当前的 HEAD</li><li><code>-o -|NAME.xml</code>,<code>--output-file=-|NAME.xml</code>：把 manifest 存为 NAME.xml</li></ul><p><strong>示例：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取仓库的sha1值，并记录在一个新的release.xml文件中</span></span><br><span class="line">repo manifest -o release.xml -r</span><br></pre></td></tr></table></figure><h2 id="24、repo-工作流程"><a href="#24、repo-工作流程" class="headerlink" title="24、repo 工作流程"></a>24、repo 工作流程</h2><p>常用的 repo 工作流程如下：</p><p><img src="/images/loading.gif" data-original="https://github.com/winter-ruize/blog_images/raw/main/images/2024/01/31/1706702493497.png" alt="在这里插入图片描述"></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://winter-ruize.github.io">Winter</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://winter-ruize.github.io/posts/91e0/">https://winter-ruize.github.io/posts/91e0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://winter-ruize.github.io" target="_blank">Winter's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/git/">git</a><a class="post-meta__tags" href="/tags/repo/">repo</a></div><div class="post_share"><div class="social-share" data-image="/images/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/39c7/" title="android.view.KeyEvent"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">android.view.KeyEvent</div></div></a></div><div class="next-post pull-right"><a href="/posts/cd9b/" title="通过 X11 运行 Linux 图形化界面"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">通过 X11 运行 Linux 图形化界面</div></div></a></div></nav><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Winter</div><div class="author-info__description">Study hard and make progress every day!</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/winter-ruize"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/winter-ruize" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:winter.ruize@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#git-repo-%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B"><span class="toc-text">git repo 工具使用教程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81repo-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">1、repo 是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8-repo%EF%BC%9F"><span class="toc-text">2、为什么要用 repo？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81repo-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"><span class="toc-text">3、repo 下载安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81repo-help"><span class="toc-text">4、repo help</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81repo-version"><span class="toc-text">5、repo version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81repo-selfupdate"><span class="toc-text">6、repo selfupdate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81repo-init"><span class="toc-text">7、repo init</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1%E3%80%81%E4%BF%AE%E6%94%B9%E8%8E%B7%E5%8F%96repo%E7%9A%84%E6%BA%90%E7%A0%81%E8%B7%AF%E5%BE%84"><span class="toc-text">7.1、修改获取repo的源码路径</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%881%EF%BC%9A"><span class="toc-text">解决方案1：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%882%EF%BC%9A"><span class="toc-text">解决方案2：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81-repo-%E6%96%87%E4%BB%B6%E5%A4%B9%E7%AE%80%E4%BB%8B"><span class="toc-text">8、.repo 文件夹简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81manifest-%E6%96%87%E4%BB%B6%E4%BB%8B%E7%BB%8D"><span class="toc-text">9、manifest 文件介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1%E3%80%81manifest-%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-text">9.1、manifest 文件格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2%E3%80%81remote-%E5%85%83%E7%B4%A0"><span class="toc-text">9.2、remote 元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3%E3%80%81default-%E5%85%83%E7%B4%A0"><span class="toc-text">9.3、default 元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4%E3%80%81project-%E5%85%83%E7%B4%A0"><span class="toc-text">9.4、project 元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5%E3%80%81copyfile-%E5%85%83%E7%B4%A0"><span class="toc-text">9.5、copyfile 元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-6%E3%80%81linkfile-%E5%85%83%E7%B4%A0"><span class="toc-text">9.6、linkfile 元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10%E3%80%81repo-sync"><span class="toc-text">10、repo sync</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11%E3%80%81repo-start"><span class="toc-text">11、repo start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12%E3%80%81repo-status"><span class="toc-text">12、repo status</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13%E3%80%81repo-checkout"><span class="toc-text">13、repo checkout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14%E3%80%81repo-branch"><span class="toc-text">14、repo branch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15%E3%80%81repo-diff"><span class="toc-text">15、repo diff</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16%E3%80%81repo-stage"><span class="toc-text">16、repo stage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17%E3%80%81repo-forall"><span class="toc-text">17、repo forall</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18%E3%80%81repo-prune"><span class="toc-text">18、repo prune</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19%E3%80%81repo-abandon"><span class="toc-text">19、repo abandon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20%E3%80%81repo-upload"><span class="toc-text">20、repo upload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21%E3%80%81repo-download"><span class="toc-text">21、repo download</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22%E3%80%81repo-grep"><span class="toc-text">22、repo grep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23%E3%80%81repo-manifest"><span class="toc-text">23、repo manifest</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24%E3%80%81repo-%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">24、repo 工作流程</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/f4b/" title="Android 多媒体框架简介">Android 多媒体框架简介</a><time datetime="2024-03-13T06:25:33.000Z" title="发表于 2024-03-13 14:25:33">2024-03-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8656/" title="android 各种文件夹路径">android 各种文件夹路径</a><time datetime="2024-03-12T03:49:42.000Z" title="发表于 2024-03-12 11:49:42">2024-03-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/8b22/" title="ANR 触发原理与分析">ANR 触发原理与分析</a><time datetime="2024-02-01T08:53:39.000Z" title="发表于 2024-02-01 16:53:39">2024-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/75d1/" title="ATV 开机向导定制化与预置客制化 Launcher">ATV 开机向导定制化与预置客制化 Launcher</a><time datetime="2024-02-01T08:53:39.000Z" title="发表于 2024-02-01 16:53:39">2024-02-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/e1e6/" title="Android Binder(C++ 实现)">Android Binder(C++ 实现)</a><time datetime="2024-02-01T08:53:39.000Z" title="发表于 2024-02-01 16:53:39">2024-02-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By Winter</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://vercel-blog-lime.vercel.app/",region:"ap-shanghai",onCommentLoaded:()=>{btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null))},o=()=>{"object"==typeof twikoo?setTimeout(t,0):getScript("https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js").then(t)};o()})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>